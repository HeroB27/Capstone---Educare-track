<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Management - Educare Track</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <link rel="stylesheet" href="../css/styles.css">
</head>
<body class="bg-gray-50 theme-admin min-h-screen flex">
    <!-- Sidebar -->
    <aside id="sidebar" class="w-64 bg-white border-r border-gray-200 sidebar-transition fixed h-full z-40"></aside>

    <!-- Main Content -->
    <main class="flex-1 ml-64 p-8">
        <!-- Header -->
        <header class="flex justify-between items-center mb-8"></header>

        <!-- User Management Section -->
        <section id="usersSection" class="section-content">
            <div class="flex justify-between items-center mb-6">
                <div class="flex space-x-4">
                    <div class="relative">
                        <span class="absolute inset-y-0 left-0 pl-3 flex items-center text-gray-400">
                            <i data-lucide="search" class="w-5 h-5"></i>
                        </span>
                        <input type="text" id="userSearch" placeholder="Search users..." 
                            class="pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:ring-violet-500 focus:border-violet-500 outline-none w-64">
                    </div>
                    <select id="roleFilter" class="px-4 py-2 border border-gray-200 rounded-lg focus:ring-violet-500 outline-none">
                        <option value="all">All Roles</option>
                        <option value="teacher">Teachers</option>
                        <option value="parent">Parents</option>
                        <option value="guard">Guard</option>
                        <option value="clinic">Clinic</option>
                    </select>
                </div>
                <div class="flex space-x-2">
                    <button id="addStaffBtn" class="bg-violet-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-violet-700 flex items-center space-x-2">
                        <i data-lucide="plus" class="w-5 h-5"></i>
                        <span>Add Staff</span>
                    </button>
                    <button id="addParentStudentBtn" class="bg-indigo-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-indigo-700 flex items-center space-x-2">
                        <i data-lucide="user-plus" class="w-5 h-5"></i>
                        <span>Add Parent/Student</span>
                    </button>
                </div>
            </div>

            <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
                <table class="w-full text-left">
                    <thead class="bg-gray-50 border-b border-gray-100">
                        <tr>
                            <th class="px-6 py-4 text-sm font-bold text-gray-600">Name</th>
                            <th class="px-6 py-4 text-sm font-bold text-gray-600">Role</th>
                            <th class="px-6 py-4 text-sm font-bold text-gray-600">Contact</th>
                            <th class="px-6 py-4 text-sm font-bold text-gray-600">Status</th>
                            <th class="px-6 py-4 text-sm font-bold text-gray-600">Gatekeeper</th>
                            <th class="px-6 py-4 text-sm font-bold text-gray-600">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="userTableBody">
                        <!-- Table rows will be injected here -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Modal: Add Staff (Multi-step) -->
        <div id="staffModal" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4 modal-backdrop">
            <div class="bg-white rounded-2xl shadow-2xl max-w-lg w-full">
                <div class="p-6 border-b border-gray-100 flex justify-between items-center">
                    <h3 class="text-xl font-bold text-gray-900">Add Staff Member</h3>
                    <button class="close-staff-modal text-gray-400 hover:text-gray-600">
                        <i data-lucide="x" class="w-6 h-6"></i>
                    </button>
                </div>
                
                <div class="p-6">
                    <!-- Progress Bar -->
                    <div class="flex items-center justify-between mb-8 relative">
                        <div class="absolute top-1/2 left-0 w-full h-1 bg-gray-100 -z-10 -translate-y-1/2"></div>
                        <div id="staff-step-line" class="absolute top-1/2 left-0 w-0 h-1 bg-violet-600 -z-10 -translate-y-1/2 transition-all duration-300"></div>
                        
                        <div class="flex flex-col items-center">
                            <div class="staff-step-circle w-8 h-8 rounded-full bg-violet-600 text-white flex items-center justify-center font-bold mb-2">1</div>
                            <span class="text-[10px] font-medium text-violet-600 uppercase tracking-widest">Role</span>
                        </div>
                        <div class="flex flex-col items-center">
                            <div class="staff-step-circle w-8 h-8 rounded-full bg-gray-200 text-gray-600 flex items-center justify-center font-bold mb-2">2</div>
                            <span class="text-[10px] font-medium text-gray-500 uppercase tracking-widest">Personal</span>
                        </div>
                        <div class="flex flex-col items-center">
                            <div class="staff-step-circle w-8 h-8 rounded-full bg-gray-200 text-gray-600 flex items-center justify-center font-bold mb-2">3</div>
                            <span class="text-[10px] font-medium text-gray-500 uppercase tracking-widest">Account</span>
                        </div>
                    </div>

                    <!-- Step 1: Role Selection -->
                    <div id="staffStep1" class="staff-step-content">
                        <label class="block text-sm font-medium text-gray-700 mb-4 text-center">Select Staff Role</label>
                        <div class="grid grid-cols-1 gap-3">
                            <button type="button" onclick="selectStaffRole('teacher')" class="role-option p-4 border-2 border-gray-100 rounded-2xl hover:border-violet-200 hover:bg-violet-50 transition-all flex items-center space-x-4 group">
                                <div class="w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center text-blue-600">
                                    <i data-lucide="book-open" class="w-6 h-6"></i>
                                </div>
                                <div class="text-left">
                                    <p class="font-bold text-gray-900">Teacher</p>
                                    <p class="text-xs text-gray-500">Manage classes and attendance</p>
                                </div>
                            </button>
                            <button type="button" onclick="selectStaffRole('guard')" class="role-option p-4 border-2 border-gray-100 rounded-2xl hover:border-violet-200 hover:bg-violet-50 transition-all flex items-center space-x-4 group">
                                <div class="w-12 h-12 bg-yellow-100 rounded-xl flex items-center justify-center text-yellow-600">
                                    <i data-lucide="shield" class="w-6 h-6"></i>
                                </div>
                                <div class="text-left">
                                    <p class="font-bold text-gray-900">Guard / Security</p>
                                    <p class="text-xs text-gray-500">Gate scanning and monitoring</p>
                                </div>
                            </button>
                            <button type="button" onclick="selectStaffRole('clinic')" class="role-option p-4 border-2 border-gray-100 rounded-2xl hover:border-violet-200 hover:bg-violet-50 transition-all flex items-center space-x-4 group">
                                <div class="w-12 h-12 bg-red-100 rounded-xl flex items-center justify-center text-red-600">
                                    <i data-lucide="cross" class="w-6 h-6"></i>
                                </div>
                                <div class="text-left">
                                    <p class="font-bold text-gray-900">Clinic Staff</p>
                                    <p class="text-xs text-gray-500">Health and medical tracking</p>
                                </div>
                            </button>
                        </div>
                        <input type="hidden" id="staffRole">
                    </div>

                    <!-- Step 2: Personal Information -->
                    <div id="staffStep2" class="staff-step-content hidden">
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Full Name</label>
                                <input type="text" id="staffFullName" class="w-full px-4 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-violet-500" placeholder="e.g. Maria Clara">
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Contact Number</label>
                                    <input type="tel" id="staffPhone" class="w-full px-4 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-violet-500" placeholder="09123456789">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Email Address</label>
                                    <input type="email" id="staffEmail" class="w-full px-4 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-violet-500" placeholder="maria@educare.edu">
                                </div>
                            </div>
                            <div id="teacherFields" class="hidden">
                                <label class="block text-sm font-medium text-gray-700 mb-1">Employee ID (Optional)</label>
                                <input type="text" id="staffEmployeeID" class="w-full px-4 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-violet-500">
                            </div>
                        </div>
                    </div>

                    <!-- Step 3: Account Creation -->
                    <div id="staffStep3" class="staff-step-content hidden">
                        <div class="space-y-4">
                            <div class="p-4 bg-violet-50 rounded-xl mb-4">
                                <p class="text-xs text-violet-700 font-bold mb-1">Generated Staff ID:</p>
                                <p id="generatedStaffIDDisplay" class="text-sm font-black text-gray-900 font-mono tracking-wider">-- PENDING --</p>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Username</label>
                                <input type="text" id="staffUsername" class="w-full px-4 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-violet-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Password</label>
                                <input type="password" id="staffPassword" class="w-full px-4 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-violet-500">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="p-6 border-t border-gray-100 flex justify-between">
                    <button id="prevStaffStep" class="hidden px-6 py-2 border border-gray-300 rounded-lg font-medium text-gray-600 hover:bg-gray-50">Previous</button>
                    <div class="flex-1"></div>
                    <button id="nextStaffStep" class="px-6 py-2 bg-violet-600 text-white rounded-lg font-medium hover:bg-violet-700">Next</button>
                </div>
            </div>
        </div>

        <!-- Modal: Add Parent & Student (Multi-step) -->
        <div id="parentStudentModal" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4 modal-backdrop overflow-y-auto">
            <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full my-8">
                <div class="p-6 border-b border-gray-100 flex justify-between items-center">
                    <h3 class="text-xl font-bold text-gray-900">Add Parent & Student</h3>
                    <button class="close-modal text-gray-400 hover:text-gray-600">
                        <i data-lucide="x" class="w-6 h-6"></i>
                    </button>
                </div>
                
                <div class="p-6">
                    <!-- Progress Bar -->
                    <div class="flex items-center justify-between mb-8 relative">
                        <div class="absolute top-1/2 left-0 w-full h-1 bg-gray-100 -z-10 -translate-y-1/2"></div>
                        <div id="step-line" class="absolute top-1/2 left-0 w-0 h-1 bg-violet-600 -z-10 -translate-y-1/2 transition-all duration-300"></div>
                        
                        <div class="flex flex-col items-center">
                            <div class="step-circle w-8 h-8 rounded-full bg-violet-600 text-white flex items-center justify-center font-bold mb-2">1</div>
                            <span class="text-xs font-medium text-violet-600">Parent Info</span>
                        </div>
                        <div class="flex flex-col items-center">
                            <div class="step-circle w-8 h-8 rounded-full bg-gray-200 text-gray-600 flex items-center justify-center font-bold mb-2">2</div>
                            <span class="text-xs font-medium text-gray-500">Account</span>
                        </div>
                        <div class="flex flex-col items-center">
                            <div class="step-circle w-8 h-8 rounded-full bg-gray-200 text-gray-600 flex items-center justify-center font-bold mb-2">3</div>
                            <span class="text-xs font-medium text-gray-500">Student Info</span>
                        </div>
                        <div class="flex flex-col items-center">
                            <div class="step-circle w-8 h-8 rounded-full bg-gray-200 text-gray-600 flex items-center justify-center font-bold mb-2">4</div>
                            <span class="text-xs font-medium text-gray-500">ID Card</span>
                        </div>
                    </div>

                    <!-- Step 1: Parent Information -->
                    <div id="step1" class="step-content">
                        <div class="grid grid-cols-2 gap-4">
                            <div class="col-span-2">
                                <label class="block text-sm font-medium text-gray-700 mb-1">Full Name</label>
                                <input type="text" id="parentFullName" class="w-full px-4 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-violet-500" placeholder="e.g. Juan Dela Cruz">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Phone Number</label>
                                <input type="tel" id="parentPhone" class="w-full px-4 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-violet-500" placeholder="09123456789">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Role</label>
                                <select id="parentRoleType" class="w-full px-4 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-violet-500">
                                    <option value="parent">Parent</option>
                                    <option value="guardian">Guardian</option>
                                </select>
                            </div>
                            <div class="col-span-2">
                                <label class="block text-sm font-medium text-gray-700 mb-1">Address</label>
                                <textarea id="parentAddress" rows="2" class="w-full px-4 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-violet-500" placeholder="Street, Barangay, City"></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Step 2: Account Creation -->
                    <div id="step2" class="step-content hidden">
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Username</label>
                                <input type="text" id="parentUsername" class="w-full px-4 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-violet-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Password</label>
                                <input type="password" id="parentPassword" class="w-full px-4 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-violet-500">
                            </div>
                        </div>
                    </div>

                    <!-- Step 3: Student Information -->
                    <div id="step3" class="step-content hidden">
                        <div class="grid grid-cols-2 gap-4">
                            <div class="col-span-2 flex justify-center mb-4">
                                <div class="relative group">
                                    <div id="studentPhotoPreview" class="w-32 h-32 bg-gray-100 rounded-full flex items-center justify-center border-2 border-dashed border-gray-300 overflow-hidden">
                                        <i data-lucide="camera" class="text-gray-400 w-8 h-8"></i>
                                    </div>
                                    <input type="file" id="studentPhotoInput" accept="image/*" class="hidden">
                                    <button type="button" onclick="document.getElementById('studentPhotoInput').click()" class="absolute bottom-0 right-0 bg-violet-600 text-white p-2 rounded-full shadow-lg hover:bg-violet-700 transition-all">
                                        <i data-lucide="plus" class="w-4 h-4"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="col-span-2">
                                <label class="block text-sm font-medium text-gray-700 mb-1">Student Full Name</label>
                                <input type="text" id="studentFullName" class="w-full px-4 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-violet-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">LRN</label>
                                <input type="text" id="studentLRN" class="w-full px-4 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-violet-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Grade Level</label>
                                <select id="studentGrade" class="w-full px-4 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-violet-500">
                                    <option value="Kinder">Kinder</option>
                                    <option value="1">Grade 1</option>
                                    <option value="2">Grade 2</option>
                                    <option value="3">Grade 3</option>
                                    <option value="4">Grade 4</option>
                                    <option value="5">Grade 5</option>
                                    <option value="6">Grade 6</option>
                                    <option value="7">Grade 7</option>
                                    <option value="8">Grade 8</option>
                                    <option value="9">Grade 9</option>
                                    <option value="10">Grade 10</option>
                                    <option value="11">Grade 11</option>
                                    <option value="12">Grade 12</option>
                                </select>
                            </div>
                            <div id="strandContainer" class="hidden">
                                <label class="block text-sm font-medium text-gray-700 mb-1">Strand</label>
                                <select id="studentStrand" class="w-full px-4 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-violet-500">
                                    <option value="ABM">ABM</option>
                                    <option value="STEM">STEM</option>
                                    <option value="HUMSS">HUMSS</option>
                                    <option value="TVL-ICT">TVL-ICT</option>
                                </select>
                            </div>
                        </div>
                        <div class="mt-6 p-4 bg-violet-50 rounded-xl">
                            <h5 class="text-xs font-bold text-violet-700 uppercase tracking-widest mb-2">Students to be added:</h5>
                            <div id="tempStudentList" class="space-y-2">
                                <!-- Temporary student list for multi-student support -->
                                <p class="text-xs text-gray-400 italic">No students added yet.</p>
                            </div>
                        </div>
                        <div class="mt-6 flex items-center justify-between">
                            <button type="button" id="addAnotherStudentBtn" class="text-violet-600 text-sm font-bold flex items-center space-x-1 hover:text-violet-700">
                                <i data-lucide="plus" class="w-4 h-4"></i>
                                <span>Add Student to List</span>
                            </button>
                        </div>
                    </div>

                    <!-- Step 4: ID Card Preview -->
                    <div id="step4" class="step-content hidden">
                        <div class="flex flex-col items-center">
                            <div id="previewCardsContainer" class="w-full overflow-x-auto pb-6 flex space-x-6 scrollbar-hide">
                                <!-- Multiple ID cards will be injected here -->
                                <div id="idCardPreview" class="bg-white border border-gray-200 shadow-xl flex shrink-0" style="width: 500px; height: 300px;">
                                    <!-- Front -->
                                    <div class="w-1/2 p-4 border-r border-dashed border-gray-300 flex flex-col items-center text-center">
                                        <p class="text-[10px] font-bold text-violet-700 uppercase">Educare Colleges Inc</p>
                                        <p class="text-[8px] text-gray-500">Purok 4 Irisan Baguio City</p>
                                        <div id="previewPhotoContainer" class="w-24 h-24 bg-gray-100 rounded-full my-3 flex items-center justify-center border-2 border-violet-100 overflow-hidden">
                                            <i data-lucide="user" class="text-gray-300 w-12 h-12"></i>
                                        </div>
                                        <p id="previewName" class="text-sm font-bold text-gray-900 leading-tight"></p>
                                        <p id="previewAddress" class="text-[8px] text-gray-500 mt-1"></p>
                                        <p id="previewClass" class="text-[10px] font-bold text-violet-600 mt-2"></p>
                                    </div>
                                    <!-- Back -->
                                    <div class="w-1/2 p-4 flex flex-col items-center justify-between">
                                        <div id="previewQR" class="w-24 h-24 bg-white p-1"></div>
                                        <div class="text-center">
                                            <p id="previewID" class="text-[10px] font-mono text-gray-900 font-bold"></p>
                                            <p id="previewParent" class="text-[8px] text-gray-500 mt-1"></p>
                                            <p id="previewPhone" class="text-[8px] text-gray-500"></p>
                                        </div>
                                        <p class="text-[6px] text-gray-400 mt-2">If found, please return to Educare Colleges Inc.</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="flex space-x-4">
                                <button id="bulkPrintBtn" class="bg-violet-600 text-white px-8 py-2 rounded-lg font-bold hover:bg-violet-700 transition-all flex items-center space-x-2">
                                    <i data-lucide="printer" class="w-5 h-5"></i>
                                    <span>Print All IDs</span>
                                </button>
                                <p class="text-xs text-gray-400 mt-2 italic flex items-center">
                                    <i data-lucide="info" class="w-3 h-3 mr-1"></i>
                                    Review all cards before saving
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="p-6 border-t border-gray-100 flex justify-between">
                    <button id="prevStep" class="hidden px-6 py-2 border border-gray-300 rounded-lg font-medium text-gray-600 hover:bg-gray-50">Previous</button>
                    <div class="flex-1"></div>
                    <button id="nextStep" class="px-6 py-2 bg-violet-600 text-white rounded-lg font-medium hover:bg-violet-700">Next</button>
                </div>
            </div>
        </div>

        <!-- Modal: Edit User -->
        <div id="editUserModal" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4 modal-backdrop">
            <div class="bg-white rounded-2xl shadow-2xl max-w-lg w-full p-6">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-xl font-bold text-gray-900">Edit User Profile</h3>
                    <button class="close-edit-modal text-gray-400 hover:text-gray-600">
                        <i data-lucide="x" class="w-6 h-6"></i>
                    </button>
                </div>
                
                <form id="editUserForm" class="space-y-4">
                    <input type="hidden" id="editUserID">
                    <div class="flex justify-center mb-4">
                        <div class="relative group">
                            <div id="editPhotoPreview" class="w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center border-2 border-violet-100 overflow-hidden">
                                <i data-lucide="user" class="text-gray-300 w-12 h-12"></i>
                            </div>
                            <input type="file" id="editPhotoInput" accept="image/*" class="hidden">
                            <button type="button" onclick="document.getElementById('editPhotoInput').click()" class="absolute bottom-0 right-0 bg-violet-600 text-white p-1.5 rounded-full shadow-lg hover:bg-violet-700 transition-all">
                                <i data-lucide="camera" class="w-3 h-3"></i>
                            </button>
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Full Name</label>
                        <input type="text" id="editFullName" required class="w-full px-4 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-violet-500">
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Phone Number</label>
                            <input type="tel" id="editPhone" required class="w-full px-4 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-violet-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                            <input type="email" id="editEmail" class="w-full px-4 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-violet-500">
                        </div>
                    </div>
                    
                    <div id="parentExtraFields" class="hidden space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Address</label>
                            <textarea id="editAddress" rows="2" class="w-full px-4 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-violet-500"></textarea>
                        </div>
                        <div class="p-3 bg-amber-50 rounded-lg border border-amber-100 flex items-start space-x-3">
                            <i data-lucide="alert-triangle" class="text-amber-600 w-5 h-5 shrink-0 mt-0.5"></i>
                            <p class="text-[10px] text-amber-700 font-medium">Changing parent information requires re-issuing the Student ID card to update the contact details on the back.</p>
                        </div>
                    </div>

                    <div id="teacherExtraFields" class="hidden space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Employee Number</label>
                            <input type="text" id="editEmployeeNo" class="w-full px-4 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-violet-500">
                        </div>
                        <div class="flex items-center space-x-2">
                            <input type="checkbox" id="editIsGatekeeper" class="w-4 h-4 text-violet-600 border-gray-300 rounded focus:ring-violet-500">
                            <label class="text-sm font-medium text-gray-700">Assign as Gatekeeper (Can scan IDs)</label>
                        </div>
                    </div>

                    <div id="guardExtraFields" class="hidden space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Duty Shift</label>
                            <select id="editShift" class="w-full px-4 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-violet-500">
                                <option value="Day">Day Shift</option>
                                <option value="Night">Night Shift</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Assigned Gate</label>
                            <input type="text" id="editGate" class="w-full px-4 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-violet-500">
                        </div>
                    </div>

                    <div id="clinicExtraFields" class="hidden space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">License Number</label>
                            <input type="text" id="editLicense" class="w-full px-4 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-violet-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Position</label>
                            <input type="text" id="editPosition" class="w-full px-4 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-violet-500">
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Status</label>
                        <select id="editStatus" class="w-full px-4 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-violet-500">
                            <option value="true">Active</option>
                            <option value="false">Inactive</option>
                        </select>
                    </div>

                    <div class="pt-4 border-t border-gray-100">
                        <div class="flex justify-between items-center mb-2">
                            <h4 class="text-sm font-bold text-gray-900">Security</h4>
                            <span class="text-[10px] text-gray-400 font-medium">Leave blank to keep current password</span>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">New Password</label>
                                <input type="password" id="editPassword" class="w-full px-4 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-violet-500" placeholder="••••••••">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Confirm Password</label>
                                <input type="password" id="editConfirmPassword" class="w-full px-4 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-violet-500" placeholder="••••••••">
                            </div>
                        </div>
                    </div>

                    <div class="mt-8 flex space-x-3">
                        <button type="button" class="close-edit-modal flex-1 px-4 py-2 border border-gray-300 rounded-lg font-medium text-gray-600 hover:bg-gray-50">Cancel</button>
                        <button type="submit" class="flex-1 px-4 py-2 bg-violet-600 text-white rounded-lg font-bold hover:bg-violet-700 transition-all">Save Changes</button>
                    </div>
                </form>
            </div>
        </div>
        <!-- Modal: Student Quick View -->
        <div id="quickViewModal" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4 modal-backdrop">
            <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full p-8">
                <div class="flex justify-between items-start mb-8">
                    <div class="flex items-center space-x-4">
                        <div id="qvPhoto" class="w-20 h-20 rounded-full bg-violet-100 flex items-center justify-center border-4 border-violet-50 overflow-hidden">
                            <i data-lucide="user" class="text-violet-400 w-10 h-10"></i>
                        </div>
                        <div>
                            <h3 id="qvName" class="text-2xl font-bold text-gray-900"></h3>
                            <p id="qvLRN" class="text-gray-500 font-mono text-sm"></p>
                            <span id="qvClass" class="inline-block mt-2 px-3 py-1 bg-violet-100 text-violet-700 rounded-full text-[10px] font-bold uppercase tracking-wider"></span>
                        </div>
                    </div>
                    <button class="close-qv-modal text-gray-400 hover:text-gray-600">
                        <i data-lucide="x" class="w-6 h-6"></i>
                    </button>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <div class="bg-gray-50 p-4 rounded-xl border border-gray-100">
                        <p class="text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-1">Attendance Rate</p>
                        <h4 id="qvAttendance" class="text-xl font-bold text-violet-600">--%</h4>
                    </div>
                    <div class="bg-gray-50 p-4 rounded-xl border border-gray-100">
                        <p class="text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-1">Clinic Visits</p>
                        <h4 id="qvClinic" class="text-xl font-bold text-red-600">0</h4>
                    </div>
                    <div class="bg-gray-50 p-4 rounded-xl border border-gray-100">
                        <p class="text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-1">Parent Phone</p>
                        <h4 id="qvPhone" class="text-sm font-bold text-gray-900">N/A</h4>
                    </div>
                </div>

                <div class="space-y-6">
                    <div>
                        <h4 class="text-sm font-bold text-gray-900 uppercase tracking-widest mb-4">Recent Attendance</h4>
                        <div id="qvAttendanceList" class="space-y-2">
                            <!-- Recent attendance injected here -->
                        </div>
                    </div>
                </div>

                <div class="mt-8 flex justify-between items-center">
                    <div id="adminOverrideControls" class="flex items-center space-x-2">
                        <select id="overrideStatus" class="px-4 py-2 border border-gray-200 rounded-lg text-sm focus:ring-violet-500 outline-none">
                            <option value="present">Mark Present</option>
                            <option value="late">Mark Late</option>
                            <option value="absent">Mark Absent</option>
                            <option value="excused">Mark Excused</option>
                        </select>
                        <button id="btnOverrideAtt" class="px-6 py-2 bg-amber-600 text-white rounded-lg font-bold hover:bg-amber-700 transition-all shadow-lg shadow-amber-600/20 text-sm">
                            Apply Override
                        </button>
                    </div>
                    <button class="close-qv-modal px-6 py-2 bg-gray-100 text-gray-600 rounded-lg font-medium hover:bg-gray-200 transition-all">Close Profile</button>
                </div>
            </div>
        </div>

    </main>

    <script type="module" src="../js/admin-users.js"></script>
</body>
</html>
